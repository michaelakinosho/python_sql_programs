SELECT myContests.contest_id, myContests.hacker_id, myContests.name, SUM(myColleges.total_submissions) AS [total submissions], SUM(myColleges.total_accepted_submissions) AS [total accepted submissions], SUM(myColleges.total_views) AS [total views], SUM(myColleges.total_unique_views) AS [total unique views] FROM ( SELECT * FROM (SELECT Contests.contest_id, Contests.hacker_id, Contests.name, Colleges.college_id FROM Contests LEFT OUTER JOIN Colleges ON Contests.contest_id = Colleges.contest_id GROUP BY Contests.contest_id, Contests.hacker_id, Contests.name, Colleges.college_id) AS vHackerDetail   ) AS myContests LEFT OUTER JOIN ( SELECT * FROM (SELECT qryViewSubmissions.college_id, SUM(qryViewSubmissions.[sum of total_submissions]) AS total_submissions, SUM(qryViewSubmissions.[sum of total_accepted_submissions]) AS total_accepted_submissions, SUM(qryViewSubmissions.[sum of total_views]) AS total_views, SUM(qryViewSubmissions.[sum of total_unique_views]) AS total_unique_views FROM (SELECT Challenges.college_id, IIF(SUM(Submission_Stats.total_submissions) IS NULL,0,SUM(Submission_Stats.total_submissions)) AS [sum of total_submissions], IIF(SUM(Submission_Stats.total_accepted_submissions) IS NULL,0,SUM(Submission_Stats.total_accepted_submissions)) AS [sum of total_accepted_submissions], 0 AS [sum of total_views], 0 AS [sum of total_unique_views] FROM Challenges LEFT OUTER JOIN Submission_Stats ON Challenges.challenge_id = Submission_Stats.challenge_id GROUP BY Challenges.college_id UNION SELECT  Challenges.college_id, 0 AS [sum of total_submissions], 0 AS [sum of total_accepted_submissions], IIF(SUM(View_Stats.total_views) IS NULL,0,SUM(View_Stats.total_views)) AS [sum of total_views], IIF(SUM(View_Stats.total_unique_views) IS NULL,0,SUM(View_Stats.total_unique_views)) AS [sum of total_unique_views] FROM  Challenges LEFT OUTER JOIN View_Stats ON Challenges.challenge_id = View_Stats.challenge_id GROUP BY Challenges.college_id) AS qryViewSubmissions GROUP BY qryViewSubmissions.college_id) AS vHackerStats) AS myColleges ON myContests.college_id=myColleges.college_id GROUP BY  myContests.contest_id, myContests.hacker_id, myContests.name HAVING SUM(myColleges.total_submissions)+SUM(myColleges.total_accepted_submissions)+SUM(myColleges.total_views)+SUM(myColleges.total_unique_views)>0  ORDER BY myContests.contest_id
